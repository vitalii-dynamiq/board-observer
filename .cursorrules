# Board Observer - Development Rules

> AI-powered meeting intelligence platform for enterprise board governance.
> Tech Stack: Next.js 14, React 18, Tailwind CSS, ShadCN UI, Node.js, Express, Prisma, PostgreSQL

---

## Cursor Cloud Agent Configuration

This project is configured for autonomous Cursor Cloud Agent development. The agent can:
- Set up the development environment automatically
- Run tests and verify changes
- Make code changes and push to GitHub

### Quick Start for Agents

```bash
# Complete setup from scratch
make agent-setup

# Start development servers  
make agent-start

# Run tests before committing
make agent-test

# Verify everything works
make agent-verify

# Stop all services
make agent-stop
```

### Agent Configuration Files

- `.cursor/settings.json` - Agent settings and permissions
- `.cursor/environment.json` - Environment configuration
- `.cursor/tasks.json` - Predefined tasks
- `scripts/agent-setup.sh` - Setup automation script

### Important Notes for Agents

1. **Always run `make agent-test` before committing changes**
2. **Use `make agent-verify` to check if the app is working**
3. **The app uses non-standard ports** (4280, 4281, 5481) to avoid conflicts
4. **AI features are mocked by default** (`AI_MOCK_ENABLED=true`)

---

## Project Configuration

### Non-Standard Ports (to avoid conflicts)
- **Frontend**: 4280 (default Next.js: 3000)
- **Backend**: 4281 (default Express: 3001)
- **PostgreSQL**: 5481 (default: 5432)
- **Redis**: 6381 (default: 6379)

### Key Files
- `.env.example` / `.env.local` - Frontend environment
- `backend/.env.example` / `backend/.env` - Backend environment
- `docker-compose.yml` - Full stack Docker setup
- `backend/docker-compose.yml` - Database only
- `AGENTS.md` - AI integration documentation

---

## 1. Frontend Design System

### Typography
- **Primary**: `IBM Plex Sans` for all UI text
- **Monospace**: `IBM Plex Mono` for code/technical content
- **NEVER use**: Inter, Roboto, Arial, Geist, or generic sans-serif

### Type Scale
```
text-xs    → 12px  — Labels, captions, metadata
text-sm    → 14px  — Body text, form inputs, buttons
text-base  → 16px  — Primary body, paragraphs
text-lg    → 18px  — Section headers
text-xl    → 20px  — Page section titles
text-2xl   → 24px  — Page headers
text-3xl   → 30px  — Hero sections only
```

### Font Weights
- `font-normal` (400) — Body text
- `font-medium` (500) — Buttons, labels, UI elements
- `font-semibold` (600) — Headings
- `font-bold` (700) — Critical emphasis only

---

## 2. Color Palette (Light Theme)

```css
gray: {
  50:  '#fafafa',  /* Page background */
  100: '#f4f4f5',  /* Card backgrounds, hover states */
  200: '#e4e4e7',  /* Borders, dividers */
  300: '#d4d4d8',  /* Disabled states */
  400: '#a1a1aa',  /* Placeholder text */
  500: '#71717a',  /* Secondary text */
  600: '#52525b',  /* Body text */
  700: '#3f3f46',  /* Primary text */
  800: '#27272a',  /* Headings */
  900: '#18181b',  /* High contrast text */
}
```

### FORBIDDEN Colors
- Purple gradients on white backgrounds
- Rainbow or multi-color gradients
- Neon or overly saturated colors
- More than 2 accent colors

---

## 3. Component Patterns

### Buttons
```tsx
// Primary
<Button className="bg-gray-900 text-white hover:bg-gray-800">

// Secondary
<Button variant="outline" className="border-gray-200 hover:bg-gray-50">

// Ghost
<Button variant="ghost" className="hover:bg-gray-100">
```

Rules:
- Height: `h-9` (36px) standard, `h-8` (32px) compact
- Border radius: `rounded-md` — NEVER `rounded-full` for actions
- Text: `text-sm font-medium`

### Cards
```tsx
<div className="rounded-lg border border-gray-200 bg-white p-6">
```

Rules:
- Always use `border border-gray-200`
- Shadow: `shadow-sm` max — NEVER `shadow-lg` or `shadow-xl`
- No gradient backgrounds

### Inputs
```tsx
<Input className="h-9 border-gray-200 focus:border-gray-400 focus:ring-gray-400" />
```

---

## 4. Forbidden Patterns (AI Slop)

NEVER do this:
1. Purple/violet gradients on white backgrounds
2. Multiple font families in one view
3. Excessive shadows (shadow-md, shadow-lg, shadow-xl)
4. Rounded-full buttons for primary actions
5. Emoji in UI (unless user content)
6. Colorful icons — stick to monochrome
7. Hero sections with stock gradients
8. Glowing effects or neon colors

---

## 5. Backend Development

### API Structure
```
backend/src/
├── routes/           # Express route handlers
├── services/         # Business logic
│   ├── ai/          # AI service integrations
│   ├── recall/      # Recall.ai integration
│   ├── openai/      # OpenAI integration
│   └── elevenlabs/  # ElevenLabs TTS
├── middleware/       # Express middleware
├── lib/             # Utilities (prisma, logger)
└── websocket/       # Socket.io handlers
```

### Database
- ORM: Prisma
- Schema: `backend/prisma/schema.prisma`
- Seed: `backend/prisma/seed.ts`
- Commands:
  - `npx prisma db push` - Push schema
  - `npm run db:seed` - Seed data
  - `npx prisma studio` - Visual browser

### API Conventions
```typescript
// Route handler pattern
router.get('/', async (req, res, next) => {
  try {
    const data = await prisma.model.findMany();
    res.json(data);
  } catch (error) {
    next(error);
  }
});

// Validation with Zod
const schema = z.object({
  title: z.string().min(1),
  type: z.enum(['BOARD', 'COMMITTEE', 'REVIEW']),
});
```

### WebSocket Events
```typescript
// Server → Client
io.to(meetingId).emit('transcript-update', { ... });

// Client → Server
socket.on('join-meeting', (meetingId) => { ... });
```

---

## 6. Multi-tenancy

### Organization Context
- All meetings/attendees are scoped by `organizationId`
- Filter queries: `where: { organizationId }`
- Frontend uses `OrganizationContext` for current org
- Admin users can view all organizations

### Seed Data Organizations
1. Emirates Post
2. Abu Dhabi Department of Finance
3. Abu Dhabi Department of Health
4. Abu Dhabi Department of Government Enablement
5. Mubadala Investment Company

---

## 7. AI Integration

### Mock Mode (Development)
```bash
AI_MOCK_ENABLED=true
```

### Production Mode
```bash
AI_MOCK_ENABLED=false
RECALL_API_KEY=...
OPENAI_API_KEY=...
ELEVENLABS_API_KEY=...
```

### Service Files
- `backend/src/services/recall/` - Meeting bot
- `backend/src/services/openai/` - Advisor agent
- `backend/src/services/elevenlabs/` - Text-to-speech

---

## 8. File Organization

```
board-observer/
├── app/                    # Next.js app directory
│   └── (meetings)/         # Meeting routes
├── backend/
│   ├── src/               # TypeScript source
│   ├── prisma/            # Database schema & seed
│   └── docker-compose.yml # Database container
├── components/
│   ├── ui/                # ShadCN components
│   ├── layout/            # App shell
│   └── [feature]/         # Feature components
├── lib/
│   ├── api/               # API client
│   ├── hooks/             # React hooks
│   └── types/             # TypeScript types
├── docker-compose.yml     # Full stack
├── Makefile              # Dev commands
└── AGENTS.md             # AI documentation
```

---

## 9. Quality Checklist

Before shipping:

- [ ] Only gray-50 or white backgrounds
- [ ] No shadows larger than shadow-sm
- [ ] IBM Plex Sans font family
- [ ] Buttons have consistent height (h-8 or h-9)
- [ ] Cards have border-gray-200, no gradients
- [ ] Focus states visible (ring-2)
- [ ] Icons are gray-400/gray-500
- [ ] No purple gradients
- [ ] API validates input with Zod
- [ ] Database queries include organizationId filter
- [ ] WebSocket events are typed
- [ ] Error handling with next(error)
